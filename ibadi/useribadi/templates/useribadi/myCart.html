{% extends 'useribadi/base.html' %}

{% block content %}
<div class="container py-5">
    <h4 class="text-warning mb-4 text-center">My Cart</h4>
    <div class="row">
        <!-- Left Section: Cart Items -->
        <div class="col-lg-8 mb-4">
            <div class="bg-dark text-light rounded shadow p-4">
                {% for item in cartItems %}
                <div class="d-flex flex-column flex-md-row align-items-center mb-4 text-light rounded p-3 border border-secondary product-row">
                    <!-- Product Image -->
                    <div class="me-md-4 mb-3 mb-md-0 text-center">
                        <img src="{{ item.image }}" alt="{{ item.product.product_name }}" class="img-thumbnail" style="width: 100px; height: 100px;">
                    </div>
                    
                    <!-- Product Details -->
                    <div class="flex-grow-1">
                        <h6 class="text-warning mb-1">{{ item.product.product_name }}</h6>
                        <p class="mb-1">
                            <span>Size: </span>
                            {% if item.variant %}
                                {{ item.variant.variant_name }}
                            {% else %}
                                Not Specified
                            {% endif %}
                        </p>
                        <p class="mb-1">
                            <span>Price: </span>₹{{ item.product.selling_price }}
                        </p>
                    </div>
                    
                    <!-- Quantity, Subtotal & Remove -->
                    <div class="text-center ms-md-4">
                        <!-- Quantity Adjustment -->
                        <form method="post" action="{% url 'updateCartQuantity' item.id %}">
                            {% csrf_token %}
                            <div class="quantity-control">
                                <button type="submit" name="action" value="decrease" class="quantity-btn">
                                    -
                                </button>
                                <span class="quantity-display">{{ item.quantity }}</span>
                                <button type="submit" name="action" value="increase" class="quantity-btn">
                                    +
                                </button>
                            </div>
                        </form>

                        <!-- Subtotal -->
                        <p class="text-warning mb-1 mt-3">
                            <strong>Subtotal: ₹{{ item.subTotal }}</strong>
                        </p>
                        
                        <!-- Remove Button -->
                        <a href="{% url 'removeFromCart' item.id %}" class="btn btn-danger btn-sm mt-2" title="Remove Item">
                            <i class="fas fa-trash-alt"></i> Remove
                        </a>
                    </div>
                </div>
                {% empty %}
                <div class="text-center text-warning mb-4">
                    <p>Your cart is empty!</p>
                    <a href="{% url 'shop' %}" class="btn btn-warning">Continue Shopping</a>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Right Section: Cart Summary -->
        <div class="col-lg-4">
            <div class="bg-dark text-light rounded shadow p-4">
                <h5 class="text-warning mb-4">Cart Summary</h5>
                <div class="d-flex justify-content-between mb-2">
                    <span>Subtotal:</span>
                    <span>₹{{ cartSubTotal }}</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>Delivery Charge:</span>
                    <span>₹{{ deliveryCharge }}</span>
                </div>
                <hr class="bg-warning">
                <div class="d-flex justify-content-between mb-4">
                    <span><strong>Net Total:</strong></span>
                    <span><strong>₹{{ cartTotal }}</strong></span>
                </div>
                <!-- Proceed to Checkout Button -->
                <a 
                    href="{% url 'checkoutPage' %}" 
                    class="btn btn-warning w-100 {% if not cartItems %}disabled{% endif %}"
                    {% if not cartItems %}aria-disabled="true"{% endif %}
                >
                    Proceed to Checkout
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    /* Hover Effect for Product Row */
    .product-row {
        transition: all 0.3s ease; /* Smooth transition for hover effects */
    }
    .product-row:hover {
        background-color: rgba(255, 193, 7, 0.1); /* Subtle yellow background on hover */
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Shadow effect */
        transform: scale(1.02); /* Slight zoom-in effect */
    }

    /* Quantity Control */
    .quantity-control {
        display: inline-flex;
        align-items: center;
        border: 1px solid #ffc107;
        border-radius: 5px;
        overflow: hidden;
        background-color: #343a40;
    }
    .quantity-btn {
        border: none;
        background-color: #343a40;
        color: #ffc107;
        font-size: 1.2rem;
        width: 40px;
        height: 40px;
        text-align: center;
        line-height: 40px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    .quantity-btn:hover {
        background-color: #ffc107;
        color: #343a40;
    }
    .quantity-display {
        padding: 0 10px;
        font-size: 1rem;
        min-width: 40px;
        text-align: center;
        line-height: 40px;
        background-color: #495057;
        color: #ffc107;
        border-left: 1px solid #ffc107;
        border-right: 1px solid #ffc107;
    }

    /* Disabled Button Styling */
    .btn-warning.disabled {
        background-color: #6c757d !important; /* Grayish color */
        border-color: #6c757d !important;
        cursor: not-allowed;
        pointer-events: none;
        opacity: 0.65;
    }

    /* Additional Styling */
    .form-control:focus {
        box-shadow: 0 0 10px rgba(212, 175, 55, 0.8);
    }
    .img-thumbnail {
        object-fit: cover;
        border: 2px solid #ffc107;
    }
    .btn-danger .fas {
        margin-right: 5px;
    }
    .d-flex {
        background-color: transparent !important;
    }
    .border-secondary {
        border-color: rgba(255, 255, 255, 0.2) !important;
    }
</style>
{% endblock %}
